(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     61115,       1488]
NotebookOptionsPosition[     59935,       1453]
NotebookOutlinePosition[     60294,       1469]
CellTagsIndexPosition[     60251,       1466]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{
    RowBox[{"ParentDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], "<>", 
    "\"\</Transition_Quantity_Generator/Mathematica_Scripts/\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"<<", "\"\<Transition_Definitions.m\>\""}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResetDirectory", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7482382678979*^9, 3.748238431025752*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Bnorm", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Bvec", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pos", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vel", "=", 
   RowBox[{"{", 
    RowBox[{"30", ",", 
     RowBox[{"-", "20"}], ",", "10"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.748337703838531*^9, 3.748337717801642*^9}, {
  3.748343525167264*^9, 3.7483435690558558`*^9}, {3.7483472415119467`*^9, 
  3.748347241814117*^9}, {3.748353089443392*^9, 3.748353105318386*^9}, {
  3.748370106668476*^9, 3.748370107377611*^9}, {3.748489612780249*^9, 
  3.748489612981982*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{"Set", " ", "up"}], " ", "*)"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.748426162726918*^9, 3.748426175480711*^9}}],

Cell[BoxData[
 RowBox[{"Module", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "optsfn", ",", "str", ",", "strarr", ",", "pathoptsfiles", ",", 
     "matchfunc", ",", "k", ",", "mtch", ",", "pathfn", ",", "tmpass", ",", 
     "mfe"}], "}"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"matchfunc", "[", 
      RowBox[{"strs_", ",", "match_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"pos", ",", "idx"}], "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"idx", "=", "1"}], ",", 
          RowBox[{"idx", "\[LessEqual]", 
           RowBox[{"Length", "[", "strs", "]"}]}], ",", 
          RowBox[{"idx", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"idx", "+", 
                RowBox[{"Length", "[", "match", "]"}]}], "\[LessEqual]", 
               RowBox[{"Length", "[", "strs", "]"}]}], "&&", 
              RowBox[{
               RowBox[{"strs", "[", 
                RowBox[{"[", 
                 RowBox[{"idx", "+", 
                  RowBox[{"Table", "[", 
                   RowBox[{"idx2", ",", 
                    RowBox[{"{", 
                    RowBox[{"idx2", ",", "0", ",", 
                    RowBox[{
                    RowBox[{"Length", "[", "match", "]"}], "-", "1"}]}], 
                    "}"}]}], "]"}]}], "]"}], "]"}], "\[Equal]", "match"}]}], 
             ",", 
             RowBox[{"Return", "[", 
              RowBox[{"{", 
               RowBox[{"strs", "[", 
                RowBox[{"[", 
                 RowBox[{"idx", "+", 
                  RowBox[{"Length", "[", "match", "]"}]}], "]"}], "]"}], 
               "}"}], "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", "}"}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"mfe", "[", 
      RowBox[{"strs_", ",", "match_"}], "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "tmp", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmp", "=", 
         RowBox[{"matchfunc", "[", 
          RowBox[{"strs", ",", "match"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"tmp", "\[Equal]", 
           RowBox[{"{", "}"}]}], ",", 
          RowBox[{
           RowBox[{"Return", "[", 
            RowBox[{"{", "}"}], "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"{", 
          RowBox[{"Read", "[", 
           RowBox[{
            RowBox[{"StringToStream", "[", 
             RowBox[{"tmp", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "Number"}], "]"}], 
          "}"}], "]"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"optsfn", "=", 
     RowBox[{
      RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
      "\"\<Options_Files/Illumination_Opts_File_3.txt\>\""}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"str", "=", 
     RowBox[{"OpenRead", "[", "optsfn", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"strarr", "=", 
     RowBox[{"ReadList", "[", 
      RowBox[{"str", ",", "Word"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Close", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"pathoptsfiles", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"k", "=", "1"}], ",", "True", ",", 
      RowBox[{"k", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"mtch", "=", 
        RowBox[{"matchfunc", "[", 
         RowBox[{"strarr", ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Laser\>\"", ",", "\"\<Path\>\"", ",", 
            RowBox[{"ToString", "[", "k", "]"}], ",", "\"\<File\>\"", ",", 
            "\"\<=\>\""}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"mtch", "\[Equal]", 
          RowBox[{"{", "}"}]}], ",", 
         RowBox[{
          RowBox[{"Break", "[", "]"}], ";"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"pathoptsfiles", ",", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
          RowBox[{"mtch", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}]}], "]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"stateass", "=", 
     RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"stateass", "[", "\"\<grS\>\"", "]"}], "=", 
     RowBox[{"MakeSFKet", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{
         RowBox[{"mfe", "[", 
          RowBox[{"strarr", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Ground\>\"", ",", "\"\<State\>\"", ",", "\"\<F\>\"", ",", 
             "\"\<=\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"mfe", "[", 
          RowBox[{"strarr", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Ground\>\"", ",", "\"\<State\>\"", ",", "\"\<mF\>\"", ",", 
             "\"\<=\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"stateass", "[", "\"\<exS\>\"", "]"}], "=", 
     RowBox[{"MakeSFKet", "[", 
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{
         RowBox[{"mfe", "[", 
          RowBox[{"strarr", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Excited\>\"", ",", "\"\<State\>\"", ",", "\"\<F\>\"", ",", 
             "\"\<=\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], ",", 
        RowBox[{
         RowBox[{"mfe", "[", 
          RowBox[{"strarr", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Excited\>\"", ",", "\"\<State\>\"", ",", "\"\<mF\>\"", ",", 
             "\"\<=\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"stateass", "[", "\"\<exP\>\"", "]"}], "=", 
     RowBox[{"MakePJIKet", "[", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"mfe", "[", 
           RowBox[{"strarr", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Excited\>\"", ",", "\"\<State\>\"", ",", "\"\<2J\>\"", ",", 
              "\"\<=\>\""}], "}"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"mfe", "[", 
           RowBox[{"strarr", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Excited\>\"", ",", "\"\<State\>\"", ",", "\"\<2mJ\>\"", 
              ",", "\"\<=\>\""}], "}"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", "2"}], ",", 
        RowBox[{"1", "/", "2"}], ",", 
        RowBox[{
         RowBox[{
          RowBox[{"mfe", "[", 
           RowBox[{"strarr", ",", 
            RowBox[{"{", 
             RowBox[{
             "\"\<Excited\>\"", ",", "\"\<State\>\"", ",", "\"\<2mI\>\"", 
              ",", "\"\<=\>\""}], "}"}]}], "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}], "/", "2"}]}], "}"}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"laserass", "=", 
     RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"laserass", "[", "\"\<det\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"mfe", "[", 
       RowBox[{"strarr", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Laser\>\"", ",", "\"\<Detuning\>\"", ",", "\"\<=\>\""}],
          "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"laserass", "[", "\"\<FWHM\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"mfe", "[", 
       RowBox[{"strarr", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Laser\>\"", ",", "\"\<FWHM\>\"", ",", "\"\<=\>\""}], 
         "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"laserass", "[", "\"\<det_B0\>\"", "]"}], "=", 
     RowBox[{
      RowBox[{"mfe", "[", 
       RowBox[{"strarr", ",", 
        RowBox[{"{", 
         RowBox[{"\"\<Detuning\>\"", ",", "\"\<Field\>\"", ",", "\"\<=\>\""}],
          "}"}]}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"pathparams", "=", 
     RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"Do", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"str", "=", 
        RowBox[{"OpenRead", "[", "pathfn", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"strarr", "=", 
        RowBox[{"ReadList", "[", 
         RowBox[{"str", ",", "Word"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Close", "[", "str", "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"tmpass", "=", 
        RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmpass", "[", "\"\<P\>\"", "]"}], "=", 
        RowBox[{
         RowBox[{"mfe", "[", 
          RowBox[{"strarr", ",", 
           RowBox[{"{", 
            RowBox[{"\"\<Power\>\"", ",", "\"\<=\>\""}], "}"}]}], "]"}], "[", 
         
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmpass", "[", "\"\<khat\>\"", "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mfe", "[", 
            RowBox[{"strarr", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Wave\>\"", ",", 
               RowBox[{"\"\<vector_\>\"", "<>", "tmpstr"}], ",", 
               "\"\<=\>\""}], "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"tmpstr", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmpass", "[", "\"\<focus\>\"", "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"mfe", "[", 
            RowBox[{"strarr", ",", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<Focus_\>\"", "<>", "tmpstr"}], ",", "\"\<=\>\""}],
               "}"}]}], "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"tmpstr", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmpass", "[", "\"\<waist\>\"", "]"}], "=", 
        RowBox[{
         RowBox[{"mfe", "[", 
          RowBox[{"strarr", ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Beam\>\"", ",", "\"\<waist\>\"", ",", "\"\<(radius)\>\"", 
             ",", "\"\<=\>\""}], "}"}]}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tmpass", "[", "\"\<pol\>\"", "]"}], "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"mfe", "[", 
             RowBox[{"strarr", ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"\"\<Polarization_\>\"", "<>", "tmpstr"}], ",", 
                "\"\<real\>\"", ",", "\"\<part\>\"", ",", "\"\<=\>\""}], 
               "}"}]}], "]"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}], "+", 
           RowBox[{"I", "*", 
            RowBox[{
             RowBox[{"mfe", "[", 
              RowBox[{"strarr", ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"\"\<Polarization_\>\"", "<>", "tmpstr"}], ",", 
                 "\"\<imaginary\>\"", ",", "\"\<part\>\"", ",", "\"\<=\>\""}],
                 "}"}]}], "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"tmpstr", ",", 
            RowBox[{"{", 
             RowBox[{"\"\<x\>\"", ",", "\"\<y\>\"", ",", "\"\<z\>\""}], 
             "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"pathparams", ",", "tmpass"}], "]"}], ";"}], 
      "\[IndentingNewLine]", ",", 
      RowBox[{"{", 
       RowBox[{"pathfn", ",", "pathoptsfiles"}], "}"}]}], "]"}], ";"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.748234705696362*^9, 3.748234729391322*^9}, {
   3.748234777326105*^9, 3.748234834034194*^9}, {3.748234879182106*^9, 
   3.748234930852702*^9}, {3.748234966435944*^9, 3.74823517857584*^9}, {
   3.7482354670805197`*^9, 3.748235549434263*^9}, {3.748235648252309*^9, 
   3.7482356591913958`*^9}, {3.748235752191743*^9, 3.748235784142418*^9}, {
   3.7482358242437677`*^9, 3.748235963783977*^9}, {3.748236029099347*^9, 
   3.748236333276716*^9}, {3.748236385416437*^9, 3.748236390057823*^9}, {
   3.748236449353662*^9, 3.748236519763977*^9}, {3.748236551174527*^9, 
   3.748236565402055*^9}, {3.74823659797292*^9, 3.74823664852421*^9}, {
   3.748236716847836*^9, 3.7482369331806593`*^9}, {3.748236991217244*^9, 
   3.748237192930522*^9}, {3.748237234015938*^9, 3.7482373443546352`*^9}, {
   3.748237375594304*^9, 3.748237388999208*^9}, {3.748237989942197*^9, 
   3.748238126496108*^9}, {3.748238200107272*^9, 3.748238226679482*^9}, {
   3.7482385585036507`*^9, 3.748238619062544*^9}, {3.7482386722802877`*^9, 
   3.7482387152192783`*^9}, {3.748238876502452*^9, 3.748238961920211*^9}, {
   3.7482434096489773`*^9, 3.748243410263681*^9}, {3.7482439537240458`*^9, 
   3.748244047332664*^9}, {3.748244084289246*^9, 3.748244103383079*^9}, 
   3.7482484797581177`*^9, {3.748321020031671*^9, 3.7483210201092043`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Intensity", "[", 
    RowBox[{"path_", ",", "pos_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"2", " ", 
      RowBox[{"path", "[", "\"\<P\>\"", "]"}]}], 
     RowBox[{"\[Pi]", " ", 
      SuperscriptBox[
       RowBox[{"path", "[", "\"\<waist\>\"", "]"}], "2"]}]], " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"Norm", "[", 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{"pos", "-", 
            RowBox[{"path", "[", "\"\<focus\>\"", "]"}]}], ",", 
           RowBox[{"Normalize", "[", 
            RowBox[{"path", "[", "\"\<khat\>\"", "]"}], "]"}]}], "]"}], "]"}],
         "2"], "/", 
       SuperscriptBox[
        RowBox[{"path", "[", "\"\<waist\>\"", "]"}], "2"]}]}], "]"}]}]}], 
  ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7482375637588577`*^9, 3.7482376153405743`*^9}, 
   3.748248479758913*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ElFld", "[", "vel_", "]"}], ":=", 
   RowBox[{"Cross", "[", 
    RowBox[{"vel", ",", "Bvec"}], "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.748237830495303*^9, 3.748237876056776*^9}, {
   3.7482446983997583`*^9, 3.748244707559772*^9}, 3.748248479759321*^9, {
   3.748337736016163*^9, 3.748337736530651*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "fint", ",", "reg", ",", "\[Theta]", ",", "\[Lambda]", ",", "fn", ",", 
      "dir", ",", "E", ",", "coordtbl", ",", "tbl"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"reg", "[", "E_", "]"}], ":=", 
      RowBox[{"ImplicitRegion", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[Lambda]", "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Lambda]"}], ")"}], "2"], "+", 
            RowBox[{"2", " ", "\[Lambda]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Lambda]"}], ")"}], " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "\[GreaterEqual]", 
           SuperscriptBox["E", "2"]}], ")"}], "&&", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["\[Lambda]", "2"], "+", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Lambda]"}], ")"}], "2"], "+", 
            RowBox[{"2", " ", "\[Lambda]", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", "\[Lambda]"}], ")"}], " ", 
             RowBox[{"Cos", "[", "\[Theta]", "]"}]}]}], "\[LessEqual]", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"E", "+", "0.001"}], ")"}], "2"]}], ")"}], "&&", 
         RowBox[{"0", "\[LessEqual]", "\[Theta]"}], "&&", 
         RowBox[{"\[Theta]", "\[LessEqual]", "\[Pi]"}], "&&", 
         RowBox[{"0", "\[LessEqual]", "\[Lambda]"}], "&&", 
         RowBox[{"\[Lambda]", "\[LessEqual]", "1"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Theta]", ",", "\[Lambda]"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"fint", "=", 
      RowBox[{"Compile", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"E", ",", "_Real"}], "}"}], "}"}], ",", 
        RowBox[{"NIntegrate", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "+", 
             SuperscriptBox[
              RowBox[{"Cos", "[", "\[Theta]", "]"}], "2"]}], ")"}], " ", 
           RowBox[{"Sin", "[", "\[Theta]", "]"}], "*", " ", 
           RowBox[{"Sp2SEDistr", "[", "\[Lambda]", "]"}]}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"\[Theta]", ",", "\[Lambda]"}], "}"}], "\[Element]", 
           RowBox[{"reg", "[", "E", "]"}]}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dir", "=", 
      RowBox[{
       RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<tmp/\>\""}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"fn", "=", 
      RowBox[{"dir", "<>", "\"\<Edistr.bin\>\""}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coordtbl", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{"{", 
        RowBox[{"0.001", ",", 
         RowBox[{"Table", "[", 
          RowBox[{"x", ",", 
           RowBox[{"{", 
            RowBox[{"x", ",", "0.1", ",", "0.9", ",", "0.1"}], "}"}]}], "]"}],
          ",", "0.999"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"twophElims", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Min", "[", "coordtbl", "]"}], ",", 
        RowBox[{"Max", "[", "coordtbl", "]"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"!", 
        RowBox[{"FileExistsQ", "[", "fn", "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"!", 
           RowBox[{"DirectoryQ", "[", "dir", "]"}]}], ",", 
          RowBox[{
           RowBox[{"CreateDirectory", "[", "dir", "]"}], ";"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"tbl", "=", 
         RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"AppendTo", "[", 
            RowBox[{"tbl", ",", 
             RowBox[{"fint", "[", "E", "]"}]}], "]"}], ";"}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{"{", 
           RowBox[{"E", ",", "coordtbl"}], "}"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"BinaryWrite", "[", 
         RowBox[{"fn", ",", "tbl", ",", "\"\<Real64\>\""}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Close", "[", "fn", "]"}], ";"}]}], "\[IndentingNewLine]", 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"twophEdistr", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"coordtbl", ",", 
          RowBox[{"BinaryReadList", "[", 
           RowBox[{"fn", ",", "\"\<Real64\>\""}], "]"}]}], "}"}], "]"}], 
       "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.748332974343958*^9, 3.748333168595582*^9}, {
   3.7483332452827597`*^9, 3.748333307829525*^9}, {3.748334137232162*^9, 
   3.7483344286661777`*^9}, {3.748334535506885*^9, 3.748334536887867*^9}, {
   3.7483345704769907`*^9, 3.748334605130558*^9}, {3.7483346371625357`*^9, 
   3.748334645240271*^9}, {3.7483346865293903`*^9, 3.748334687299295*^9}, {
   3.7483364342407227`*^9, 3.748336436115013*^9}, {3.748337255419856*^9, 
   3.748337256091758*^9}, {3.748337421089463*^9, 3.748337422969056*^9}, {
   3.748346805251772*^9, 3.748346815825746*^9}, {3.748406549058958*^9, 
   3.748406549582304*^9}, {3.748419261517385*^9, 3.74841928271984*^9}, {
   3.748419316071316*^9, 3.748419331925963*^9}, {3.748419404788849*^9, 
   3.748419421074873*^9}, {3.74841993271257*^9, 3.748419933824602*^9}, {
   3.748420045577365*^9, 3.748420070895788*^9}, {3.7484206814810953`*^9, 
   3.748420722045676*^9}, 3.748421353155468*^9, {3.7484225308641872`*^9, 
   3.748422537918557*^9}, {3.748422575679172*^9, 3.7484225849266863`*^9}, {
   3.748422644436163*^9, 3.748422796820394*^9}, {3.7484229925115547`*^9, 
   3.7484229928924847`*^9}, {3.748423047469751*^9, 3.748423049734106*^9}, {
   3.748423518758216*^9, 3.748423546661262*^9}, {3.748423672495468*^9, 
   3.7484236739086514`*^9}, {3.748424309104575*^9, 3.7484243583261137`*^9}, {
   3.748424497511059*^9, 3.7484245110781183`*^9}, {3.7484249089290543`*^9, 
   3.748424909538238*^9}, 3.748426074926311*^9, 3.748426549560802*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Setup1S2S", "[", 
    RowBox[{"pos_", ",", "vel_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "ionrt", ",", "onephrt", ",", "twophrt", ",", "totrt", ",", "onephsum", 
       ",", "twophsum", ",", "onephint", ",", "func"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ionrt", "=", 
       RowBox[{
        RowBox[{"IonRatedivI", "*", 
         RowBox[{"Sum", "[", 
          RowBox[{
           RowBox[{"Intensity", "[", 
            RowBox[{"path", ",", "pos"}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"path", ",", "pathparams"}], "}"}]}], "]"}]}], "/.", 
        RowBox[{"B", "\[Rule]", "Bnorm"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"onephrt", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Sp2SStarkdivEsqtot", "[", 
          RowBox[{"stateass", "[", "\"\<exS\>\"", "]"}], "]"}], "*", 
         SuperscriptBox[
          RowBox[{"Norm", "[", 
           RowBox[{"ElFld", "[", "vel", "]"}], "]"}], "2"]}], "/.", 
        RowBox[{"B", "\[Rule]", "Bnorm"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"twophrt", "=", "Sp2S"}], ";", "\[IndentingNewLine]", 
      RowBox[{"totrt", "=", 
       RowBox[{"ionrt", "+", "onephrt", "+", "twophrt"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"brratio", "=", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<ion\>\"", "\[Rule]", 
          RowBox[{"ionrt", "/", "totrt"}]}], ",", 
         RowBox[{"\"\<oneph\>\"", "\[Rule]", 
          RowBox[{"onephrt", "/", "totrt"}]}], ",", 
         RowBox[{"\"\<twoph\>\"", "\[Rule]", 
          RowBox[{"twophrt", "/", "totrt"}]}]}], "|>"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"onephbrratio", "=", 
       RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"twophbrratio", "=", 
       RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"onephscattdistr", "=", 
       RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"onephbrratio", "[", "Sket", "]"}], "=", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"Sp2SStarkdivEsq", "[", 
             RowBox[{
              RowBox[{"stateass", "[", "\"\<exS\>\"", "]"}], ",", "Sket"}], 
             "]"}], "/.", 
            RowBox[{"B", "\[Rule]", "Bnorm"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"onephscattdistr", "[", "Sket", "]"}], "=", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"DPMParams2SdivE", "[", 
                RowBox[{
                 RowBox[{"stateass", "[", "\"\<exS\>\"", "]"}], ",", "Sket"}],
                 "]"}], ".", 
               RowBox[{"EmDistr", "[", 
                RowBox[{"\[Theta]rot", ",", "\[Phi]rot"}], "]"}]}], "/", 
              RowBox[{"Sin", "[", "\[Theta]rot", "]"}]}], "/.", 
             RowBox[{"\[Theta]rot", "\[Rule]", 
              RowBox[{"ArcCos", "[", "zrot", "]"}]}]}], "/.", 
            RowBox[{"B", "\[Rule]", "Bnorm"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"onephint", "=", 
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"onephscattdistr", "[", "Sket", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"zrot", ",", 
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Phi]rot", ",", "0", ",", 
              RowBox[{"2", " ", "\[Pi]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"onephscattdistr", "[", "Sket", "]"}], "/=", 
          RowBox[{"Max", "[", 
           RowBox[{"onephint", ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "100"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"twophbrratio", "[", "Sket", "]"}], "=", 
          RowBox[{"N", "[", 
           RowBox[{
            RowBox[{"Sp2SBr2Ph", "[", 
             RowBox[{
              RowBox[{"stateass", "[", "\"\<exS\>\"", "]"}], ",", "Sket"}], 
             "]"}], "/.", 
            RowBox[{"B", "\[Rule]", "Bnorm"}]}], "]"}]}], ";"}], 
        "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"Sket", ",", "SFBasis"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"onephsum", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"onephbrratio", "[", "Sket", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Sket", ",", "SFBasis"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"twophsum", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"twophbrratio", "[", "Sket", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Sket", ",", "SFBasis"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"onephbrratio", "[", "Sket", "]"}], "/=", 
          RowBox[{"Max", "[", 
           RowBox[{"onephsum", ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "100"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"twophbrratio", "[", "Sket", "]"}], "/=", 
          RowBox[{"Max", "[", 
           RowBox[{"twophsum", ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "100"}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"Sket", ",", "SFBasis"}], "}"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7483211912764187`*^9, 3.748321206323306*^9}, {
   3.7483212980731277`*^9, 3.74832135598663*^9}, {3.748321410893519*^9, 
   3.7483214232125998`*^9}, {3.748321466681698*^9, 3.748321480484968*^9}, {
   3.748321552307362*^9, 3.748321615006625*^9}, {3.748321661428516*^9, 
   3.748321737055511*^9}, {3.74832182983963*^9, 3.748321845034019*^9}, {
   3.748321902278491*^9, 3.748321982097753*^9}, {3.748322205228217*^9, 
   3.748322231513557*^9}, {3.748322749533641*^9, 3.748322813526997*^9}, {
   3.748322857756815*^9, 3.748322879354597*^9}, {3.74832292136349*^9, 
   3.748322999104679*^9}, {3.748323142273992*^9, 3.748323165136567*^9}, {
   3.74832319746045*^9, 3.7483232193160543`*^9}, {3.7483233408221188`*^9, 
   3.7483235469807177`*^9}, {3.748331728228636*^9, 3.748331768822303*^9}, {
   3.748331799178729*^9, 3.74833183903825*^9}, {3.748331882628804*^9, 
   3.748331886458313*^9}, {3.7483329855983543`*^9, 3.748332992631031*^9}, {
   3.7483340929213448`*^9, 3.7483341294221287`*^9}, {3.7483377426250134`*^9, 
   3.748337773529531*^9}, {3.74833785669524*^9, 3.7483378926241293`*^9}, {
   3.7483384141736298`*^9, 3.748338437057035*^9}, 3.7483421848414907`*^9, {
   3.74834326726569*^9, 3.7483432826311703`*^9}, {3.748343455235169*^9, 
   3.7483434576623507`*^9}, {3.748355255597459*^9, 3.74835527159686*^9}, {
   3.748355380337027*^9, 3.748355407549074*^9}, {3.748355563005291*^9, 
   3.748355565601387*^9}, {3.7483556344713297`*^9, 3.748355671674363*^9}, {
   3.74835774463196*^9, 3.748357745288846*^9}, {3.748367948748376*^9, 
   3.748367954465497*^9}, {3.748370655065641*^9, 3.748370670173115*^9}, 
   3.748426074929373*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"SetupLyAlph", "[", 
    RowBox[{"pos_", ",", "vel_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"onephsum", ",", "onephint"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"brratio", "=", 
       RowBox[{"<|", 
        RowBox[{
         RowBox[{"\"\<ion\>\"", "\[Rule]", "0"}], ",", 
         RowBox[{"\"\<oneph\>\"", "\[Rule]", "1"}], ",", 
         RowBox[{"\"\<twoph\>\"", "\[Rule]", "0"}]}], "|>"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"onephbrratio", "=", 
       RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"onephscattdistr", "=", 
       RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"twophbrratio", "=", 
       RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"twophbrratio", "[", "Sket", "]"}], "=", "0"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"onephbrratio", "[", "Sket", "]"}], "=", 
          RowBox[{
           RowBox[{"Sp2P", "[", 
            RowBox[{
             RowBox[{"stateass", "[", "\"\<exP\>\"", "]"}], ",", "Sket"}], 
            "]"}], "/.", 
           RowBox[{"B", "\[Rule]", "Bnorm"}]}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"onephscattdistr", "[", "Sket", "]"}], "=", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"DPMParams2P", "[", 
               RowBox[{
                RowBox[{"stateass", "[", "\"\<exP\>\"", "]"}], ",", "Sket"}], 
               "]"}], ".", 
              RowBox[{"EmDistr", "[", 
               RowBox[{"\[Theta]rot", ",", "\[Phi]rot"}], "]"}]}], "/", 
             RowBox[{"Sin", "[", "\[Theta]rot", "]"}]}], "/.", 
            RowBox[{"\[Theta]rot", "\[Rule]", 
             RowBox[{"ArcCos", "[", "zrot", "]"}]}]}], "/.", 
           RowBox[{"B", "\[Rule]", "Bnorm"}]}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"onephint", "=", 
          RowBox[{"Integrate", "[", 
           RowBox[{
            RowBox[{"onephscattdistr", "[", "Sket", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"zrot", ",", 
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"\[Phi]rot", ",", "0", ",", 
              RowBox[{"2", " ", "\[Pi]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"onephscattdistr", "[", "Sket", "]"}], "/=", 
          RowBox[{"Max", "[", 
           RowBox[{"onephint", ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "100"}]]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
        ",", 
        RowBox[{"{", 
         RowBox[{"Sket", ",", "SFBasis"}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"onephsum", "=", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"onephbrratio", "[", "Sket", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Sket", ",", "SFBasis"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"onephbrratio", "[", "Sket", "]"}], "/=", 
          RowBox[{"Max", "[", 
           RowBox[{"onephsum", ",", 
            SuperscriptBox["10", 
             RowBox[{"-", "100"}]]}], "]"}]}], ";"}], ",", 
        RowBox[{"{", 
         RowBox[{"Sket", ",", "SFBasis"}], "}"}]}], "]"}], ";"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.7483211912764187`*^9, 3.748321206323306*^9}, {
   3.7483212980731277`*^9, 3.74832135598663*^9}, {3.748321410893519*^9, 
   3.7483214232125998`*^9}, {3.748321466681698*^9, 3.748321480484968*^9}, {
   3.748321552307362*^9, 3.748321615006625*^9}, {3.748321661428516*^9, 
   3.748321737055511*^9}, {3.74832182983963*^9, 3.748321845034019*^9}, {
   3.748321902278491*^9, 3.748321982097753*^9}, {3.748322205228217*^9, 
   3.748322231513557*^9}, {3.748322749533641*^9, 3.748322813526997*^9}, {
   3.748322857756815*^9, 3.748322879354597*^9}, {3.74832292136349*^9, 
   3.748322999104679*^9}, {3.748323142273992*^9, 3.748323165136567*^9}, {
   3.74832319746045*^9, 3.7483232193160543`*^9}, {3.7483233408221188`*^9, 
   3.748323620239808*^9}, {3.748323701576262*^9, 3.748323720898637*^9}, {
   3.748334958908893*^9, 3.7483349764420547`*^9}, 3.74833502812566*^9, {
   3.7483350786054287`*^9, 3.7483351119507732`*^9}, {3.748335146446083*^9, 
   3.748335202257928*^9}, 3.7483352435593367`*^9, {3.748335296268948*^9, 
   3.748335309583397*^9}, {3.748335518442733*^9, 3.7483355304087152`*^9}, 
   3.748335581911099*^9, {3.7483377493403788`*^9, 3.748337782271091*^9}, {
   3.7483378235712442`*^9, 3.748337837763056*^9}, 3.748337898919807*^9, {
   3.748338385772324*^9, 3.748338399510044*^9}, {3.7483421752658787`*^9, 
   3.7483421793490667`*^9}, {3.748343164348878*^9, 3.7483431822137423`*^9}, {
   3.7483432352846413`*^9, 3.748343247708708*^9}, {3.748347656320833*^9, 
   3.7483476983425198`*^9}, {3.748358130302999*^9, 3.748358132352223*^9}, 
   3.748426074931754*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"run", "[", "str_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "dir", ",", "tmpion", ",", "tot", ",", "xhat", ",", "yhat", ",", "zhat", 
      ",", "dv", ",", "dataz", ",", "plotz", ",", "histz", ",", "data\[Phi]", 
      ",", "plot\[Phi]", ",", "hist\[Phi]", ",", "E2phdata", ",", "plotE", 
      ",", "histE", ",", "prefix", ",", "int"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"str", "\[Equal]", "\"\<LyAlph\>\""}], ",", 
       RowBox[{"SetupLyAlph", "[", 
        RowBox[{"pos", ",", "vel"}], "]"}], ",", 
       RowBox[{"Setup1S2S", "[", 
        RowBox[{"pos", ",", "vel"}], "]"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"zhat", "=", 
      RowBox[{"Normalize", "[", "Bvec", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"yhat", "=", 
      RowBox[{"Normalize", "[", 
       RowBox[{"Cross", "[", 
        RowBox[{"zhat", ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"str", "\[Equal]", "\"\<LyAlph\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
           RowBox[{"ElFld", "[", "vel", "]"}]}], "]"}]}], "]"}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"xhat", "=", 
      RowBox[{"Normalize", "[", 
       RowBox[{"Cross", "[", 
        RowBox[{"yhat", ",", "zhat"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmp1phmap", "=", 
      RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tmp2phmap", "=", 
      RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dir", "=", 
         RowBox[{
          RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<tmp/\>\""}]}], 
        ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp1phmap", "[", "Sket", "]"}], "=", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"BinaryReadList", "[", 
              RowBox[{
               RowBox[{"dir", "<>", "str", "<>", "\"\<_dv_1ph_\>\"", "<>", 
                RowBox[{"FketToStr", "[", 
                 RowBox[{"1", ",", "Sket"}], "]"}], "<>", "\"\<.bin\>\""}], 
               ",", "\"\<Real64\>\""}], "]"}], ",", "3"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"tmp2phmap", "[", "Sket", "]"}], "=", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{"Partition", "[", 
            RowBox[{
             RowBox[{"BinaryReadList", "[", 
              RowBox[{
               RowBox[{"dir", "<>", "str", "<>", "\"\<_dv_2ph_\>\"", "<>", 
                RowBox[{"FketToStr", "[", 
                 RowBox[{"1", ",", "Sket"}], "]"}], "<>", "\"\<.bin\>\""}], 
               ",", "\"\<Real64\>\""}], "]"}], ",", "3"}], "]"}], "[", 
           RowBox[{"[", 
            RowBox[{"2", ";;"}], "]"}], "]"}]}]}], ";"}], 
       "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"Sket", ",", "SFBasis"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tmpion", "=", 
      RowBox[{
       RowBox[{"BinaryReadList", "[", 
        RowBox[{
         RowBox[{"dir", "<>", "str", "<>", "\"\<_Ionized_Count.bin\>\""}], 
         ",", "\"\<Real64\>\""}], "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"tot", "=", 
      RowBox[{
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"tmp1phmap", "[", "Sket", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Sket", ",", "SFBasis"}], "}"}]}], "]"}], "+", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{"Length", "[", 
          RowBox[{"tmp2phmap", "[", "Sket", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"Sket", ",", "SFBasis"}], "}"}]}], "]"}], "+", "tmpion"}]}],
      ";", "\[IndentingNewLine]", 
     RowBox[{"brratioexp", "=", 
      RowBox[{"<|", 
       RowBox[{
        RowBox[{"\"\<ion\>\"", "\[Rule]", 
         RowBox[{"tmpion", "/", "tot"}]}], ",", 
        RowBox[{"\"\<oneph\>\"", "\[Rule]", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"tmp1phmap", "[", "Sket", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Sket", ",", "SFBasis"}], "}"}]}], "]"}], "/", "tot"}]}],
         ",", 
        RowBox[{"\"\<twoph\>\"", "\[Rule]", 
         RowBox[{
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{"Length", "[", 
             RowBox[{"tmp2phmap", "[", "Sket", "]"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Sket", ",", "SFBasis"}], "}"}]}], "]"}], "/", 
          "tot"}]}]}], "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"onephbrratioexp", "=", 
      RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"twophbrratioexp", "=", 
      RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"onephbrratioexp", "[", "Sket", "]"}], "=", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"tmp1phmap", "[", "Sket", "]"}], "]"}], "/", 
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"tmp1phmap", "[", "Sket2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Sket2", ",", "SFBasis"}], "}"}]}], "]"}]}], "]"}]}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"twophbrratioexp", "[", "Sket", "]"}], "=", 
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"tmp2phmap", "[", "Sket", "]"}], "]"}], "/", 
          RowBox[{"Max", "[", 
           RowBox[{"1", ",", 
            RowBox[{"Sum", "[", 
             RowBox[{
              RowBox[{"Length", "[", 
               RowBox[{"tmp2phmap", "[", "Sket2", "]"}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"Sket2", ",", "SFBasis"}], "}"}]}], "]"}]}], "]"}]}]}],
         ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"Sket", ",", "SFBasis"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dv", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"AbsSCent", "[", "2", "]"}], "-", 
         RowBox[{"AbsSCent", "[", "1", "]"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"c", "*", 
         RowBox[{"(", 
          RowBox[{"mp", "+", "me"}], ")"}]}], ")"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"z1phmap", "=", 
      RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"\[Phi]1phmap", "=", 
      RowBox[{"<|", "|>"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Do", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"dataz", "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"Prepend", "[", 
              RowBox[{
               RowBox[{"tmp1phmap", "[", "SKet", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], "]"}], ".", 
             "zhat"}], "/", "dv"}], ")"}], "[", 
          RowBox[{"[", 
           RowBox[{"2", ";;"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"plotz", "=", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"onephscattdistr", "[", "SKet", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Phi]rot", ",", "0", ",", 
               RowBox[{"2", " ", "\[Pi]"}]}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"zrot", ",", 
             RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"histz", "=", 
         RowBox[{"Histogram", "[", 
          RowBox[{"dataz", ",", "\"\<Knuth\>\"", ",", "\"\<PDF\>\""}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"z1phmap", "[", "SKet", "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"dataz", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Show", "[", 
            RowBox[{"plotz", ",", "histz"}], "]"}], ",", 
           RowBox[{"Show", "[", 
            RowBox[{"histz", ",", "plotz"}], "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"data\[Phi]", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Mod", "[", 
            RowBox[{
             RowBox[{"Arg", "[", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"vec", ".", "xhat"}], ")"}], "+", 
               RowBox[{"I", " ", 
                RowBox[{"(", 
                 RowBox[{"vec", ".", "yhat"}], ")"}]}]}], "]"}], ",", 
             RowBox[{"2", " ", "\[Pi]"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"vec", ",", 
             RowBox[{"tmp1phmap", "[", "SKet", "]"}]}], "}"}]}], "]"}]}], ";",
         "\[IndentingNewLine]", 
        RowBox[{"plot\[Phi]", "=", 
         RowBox[{"Plot", "[", 
          RowBox[{
           RowBox[{"Integrate", "[", 
            RowBox[{
             RowBox[{"onephscattdistr", "[", "SKet", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"zrot", ",", 
               RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Phi]rot", ",", "0", ",", 
             RowBox[{"2", " ", "\[Pi]"}]}], "}"}], ",", 
           RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"hist\[Phi]", "=", 
         RowBox[{"Histogram", "[", 
          RowBox[{"data\[Phi]", ",", "\"\<Knuth\>\"", ",", "\"\<PDF\>\""}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"\[Phi]1phmap", "[", "SKet", "]"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"data\[Phi]", "\[Equal]", 
            RowBox[{"{", "}"}]}], ",", 
           RowBox[{"Show", "[", 
            RowBox[{"plot\[Phi]", ",", "hist\[Phi]"}], "]"}], ",", 
           RowBox[{"Show", "[", 
            RowBox[{"hist\[Phi]", ",", "plot\[Phi]"}], "]"}]}], "]"}]}], 
        ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"SKet", ",", "SFBasis"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"E2phdata", "=", 
      RowBox[{
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Norm", "[", "x", "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", 
           RowBox[{"Catenate", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"tmp2phmap", "[", "SKet", "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"SKet", ",", "SFBasis"}], "}"}]}], "]"}], "]"}]}], 
          "}"}]}], "]"}], "/", "dv"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"int", "=", 
      RowBox[{"Integrate", "[", 
       RowBox[{
        RowBox[{"twophEdistr", "[", "EE", "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"EE", ",", 
          RowBox[{"twophElims", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"twophElims", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plotE", "=", 
      RowBox[{"Plot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"twophEdistr", "[", "EE", "]"}], "/", "int"}], ",", 
        RowBox[{"{", 
         RowBox[{"EE", ",", 
          RowBox[{"twophElims", "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", 
          RowBox[{"twophElims", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"histE", "=", 
      RowBox[{"Histogram", "[", 
       RowBox[{"E2phdata", ",", "\"\<Knuth\>\"", ",", "\"\<PDF\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Ehistplot", "=", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"E2phdata", "\[Equal]", 
         RowBox[{"{", "}"}]}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"plotE", ",", "histE"}], "]"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"histE", ",", "plotE"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Ezhist", "=", 
      RowBox[{"Histogram", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"vec", ".", "zhat"}], "/", 
           RowBox[{"Norm", "[", "vec", "]"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"vec", ",", 
            RowBox[{"Catenate", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"tmp2phmap", "[", "SKet", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"SKet", ",", "SFBasis"}], "}"}]}], "]"}], "]"}]}], 
           "}"}]}], "]"}], ",", "\"\<Knuth\>\"", ",", "\"\<PDF\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"E\[Phi]hist", "=", 
      RowBox[{"Histogram", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Mod", "[", 
           RowBox[{
            RowBox[{"Arg", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"vec", ".", "xhat"}], ")"}], "+", 
              RowBox[{"I", " ", 
               RowBox[{"(", 
                RowBox[{"vec", ".", "yhat"}], ")"}]}]}], "]"}], ",", 
            RowBox[{"2", " ", "\[Pi]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"vec", ",", 
            RowBox[{"Catenate", "[", 
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"tmp2phmap", "[", "SKet", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"SKet", ",", "SFBasis"}], "}"}]}], "]"}], "]"}]}], 
           "}"}]}], "]"}], ",", "\"\<Knuth\>\"", ",", "\"\<PDF\>\""}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"decch", "=", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"N", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "\"\<Decay Channel\>\"", ",", "\"\<Ionization\>\"", ",", 
            "\"\<1\[Gamma] Decay\>\"", ",", "\"\<2\[Gamma] Decay\>\""}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Expected BR\>\"", ",", 
            RowBox[{"brratio", "[", "\"\<ion\>\"", "]"}], ",", 
            RowBox[{"brratio", "[", "\"\<oneph\>\"", "]"}], ",", 
            RowBox[{"brratio", "[", "\"\<twoph\>\"", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"\"\<Actual BR\>\"", ",", 
            RowBox[{"brratioexp", "[", "\"\<ion\>\"", "]"}], ",", 
            RowBox[{"brratioexp", "[", "\"\<oneph\>\"", "]"}], ",", 
            RowBox[{"brratioexp", "[", "\"\<twoph\>\"", "]"}]}], "}"}]}], 
         "}"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"onephbr", "=", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"N", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<|\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"SKet", "[", "\"\<F\>\"", "]"}], "]"}], "<>", 
                "\"\<,\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"SKet", "[", "\"\<mF\>\"", "]"}], "]"}], "<>", 
                "\"\<>\>\""}], ",", 
               RowBox[{"onephbrratio", "[", "SKet", "]"}], ",", 
               RowBox[{"onephbrratioexp", "[", "SKet", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"SKet", ",", "SFBasis"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Ground Ket\>\"", ",", "\"\<Expected BR\>\"", ",", 
             "\"\<Actual BR\>\""}], "}"}]}], "]"}], "]"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"twophbr", "=", 
      RowBox[{"MatrixForm", "[", 
       RowBox[{"N", "[", 
        RowBox[{"Transpose", "[", 
         RowBox[{"Prepend", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"\"\<|\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"SKet", "[", "\"\<F\>\"", "]"}], "]"}], "<>", 
                "\"\<,\>\"", "<>", 
                RowBox[{"ToString", "[", 
                 RowBox[{"SKet", "[", "\"\<mF\>\"", "]"}], "]"}], "<>", 
                "\"\<>\>\""}], ",", 
               RowBox[{"twophbrratio", "[", "SKet", "]"}], ",", 
               RowBox[{"twophbrratioexp", "[", "SKet", "]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"SKet", ",", "SFBasis"}], "}"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "\"\<Ground Ket\>\"", ",", "\"\<Expected BR\>\"", ",", 
             "\"\<Actual BR\>\""}], "}"}]}], "]"}], "]"}], "]"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"Manipulate", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"<|", 
         RowBox[{
          RowBox[{"\"\<Branching\>\"", "->", 
           RowBox[{"Manipulate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"<|", 
               RowBox[{
                RowBox[{"\"\<decay\>\"", "\[Rule]", "decch"}], ",", 
                RowBox[{"\"\<1\[Gamma]-decay\>\"", "\[Rule]", "onephbr"}], 
                ",", 
                RowBox[{"\"\<2\[Gamma]-decay\>\"", "\[Rule]", "twophbr"}]}], 
               "|>"}], "[", "Branching", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Branching", ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<decay\>\"", ",", "\"\<1\[Gamma]-decay\>\"", ",", 
                 "\"\<2\[Gamma]-decay\>\""}], "}"}]}], "}"}]}], "]"}]}], ",", 
          
          RowBox[{"\"\<1\[Gamma] Emission Angles\>\"", "->", 
           RowBox[{"Manipulate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"<|", 
                RowBox[{
                 RowBox[{"\"\<z\>\"", "\[Rule]", "z1phmap"}], ",", 
                 RowBox[{"\"\<\[Phi]\>\"", "\[Rule]", "\[Phi]1phmap"}]}], 
                "|>"}], "[", "axis", "]"}], "[", "Sket", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"Sket", ",", "SFBasis"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"axis", ",", 
               RowBox[{"{", 
                RowBox[{"\"\<z\>\"", ",", "\"\<\[Phi]\>\""}], "}"}]}], 
              "}"}]}], "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<2\[Gamma] Emission Impluses\>\"", "\[Rule]", 
           RowBox[{"Manipulate", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"<|", 
               RowBox[{
                RowBox[{
                "\"\<Energy Distribution\>\"", "\[Rule]", "Ehistplot"}], ",", 
                
                RowBox[{"\"\<z Distribution\>\"", "\[Rule]", "Ezhist"}], ",", 
                
                RowBox[{
                "\"\<\[Phi] Distribution\>\"", "->", "E\[Phi]hist"}]}], 
               "|>"}], "[", "parameter", "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"parameter", ",", 
               RowBox[{"{", 
                RowBox[{
                "\"\<Energy Distribution\>\"", ",", "\"\<z Distribution\>\"", 
                 ",", "\"\<\[Phi] Distribution\>\""}], "}"}]}], "}"}]}], 
            "]"}]}]}], "|>"}], "[", "mode", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"mode", ",", 
         RowBox[{"{", 
          RowBox[{
          "\"\<Branching\>\"", ",", "\"\<1\[Gamma] Emission Angles\>\"", ",", 
           "\"\<2\[Gamma] Emission Impluses\>\""}], "}"}]}], "}"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.748335275456895*^9, 3.74833532928004*^9}, {
   3.74833536260944*^9, 3.748335495529524*^9}, {3.7483355597506847`*^9, 
   3.748335611535056*^9}, 3.7483361900783052`*^9, {3.748336286025652*^9, 
   3.748336295486467*^9}, {3.748336329725892*^9, 3.74833642064228*^9}, {
   3.7483375513036537`*^9, 3.748337650717568*^9}, 3.7483378021705627`*^9, {
   3.748338215118204*^9, 3.748338275047174*^9}, {3.748338310748885*^9, 
   3.748338317226698*^9}, {3.748338451931652*^9, 3.7483384868876762`*^9}, {
   3.7483405238566923`*^9, 3.7483406364415627`*^9}, {3.748340755231744*^9, 
   3.748340757701902*^9}, {3.7483408515582123`*^9, 3.7483408854306297`*^9}, {
   3.748340932528137*^9, 3.748340970112977*^9}, {3.7483470987929487`*^9, 
   3.74834715216016*^9}, {3.748347247552335*^9, 3.748347247810586*^9}, {
   3.748352413439784*^9, 3.748352455584231*^9}, {3.7483527135005407`*^9, 
   3.748352752286311*^9}, {3.748352933904819*^9, 3.748352959004381*^9}, {
   3.748353022065934*^9, 3.748353044040319*^9}, {3.748353117879567*^9, 
   3.748353148942473*^9}, {3.748354504112062*^9, 3.7483545044087467`*^9}, 
   3.748354879826209*^9, {3.7483551683482018`*^9, 3.748355183869837*^9}, {
   3.748355247518128*^9, 3.748355250271493*^9}, {3.7483581804618*^9, 
   3.748358185841797*^9}, {3.748365982141366*^9, 3.748366019877871*^9}, {
   3.748367429794785*^9, 3.748367478378792*^9}, {3.748421896374216*^9, 
   3.748421930766931*^9}, 3.748426074933461*^9, {3.748429805826788*^9, 
   3.7484298128424683`*^9}, {3.748430024080016*^9, 3.748430024330825*^9}, {
   3.748430059871193*^9, 3.748430098693232*^9}, {3.748430251274335*^9, 
   3.748430257693763*^9}, {3.748430468459338*^9, 3.7484304734456472`*^9}, {
   3.748430773481019*^9, 3.7484307749654818`*^9}, 3.748430808050877*^9, {
   3.748430848184239*^9, 3.7484308558616247`*^9}, {3.7484309177420177`*^9, 
   3.74843101693631*^9}, {3.748431060503318*^9, 3.748431071482791*^9}, {
   3.7484312910148067`*^9, 3.748431329141787*^9}}]
}, Closed]],

Cell[BoxData[
 RowBox[{"run", "[", "\"\<TwoPh\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7483531588376513`*^9, 3.748353182951704*^9}, {
  3.748354919606299*^9, 3.7483549218828*^9}}],

Cell[BoxData[
 RowBox[{"run", "[", "\"\<LyAlph\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7484317703122177`*^9, 3.748431771578891*^9}}]
},
WindowSize->{1108, 783},
WindowMargins->{{86, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 484, 11, 75, "Input"],
Cell[1045, 33, 805, 22, 96, "Input"],
Cell[CellGroupData[{
Cell[1875, 59, 208, 4, 32, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2086, 65, 14476, 355, 1083, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[16565, 422, 1027, 30, 54, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[17595, 454, 412, 9, 32, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[18010, 465, 6457, 147, 421, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[24470, 614, 7489, 169, 534, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[31962, 785, 5289, 118, 360, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[37254, 905, 22339, 536, 1419, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Closed]],
Cell[59608, 1444, 183, 3, 26, "Input"],
Cell[59794, 1449, 137, 2, 32, "Input"]
}
]
*)

